<!DOCTYPE html>
<html>
  <head>
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
 <script>

  $(document).ready(function() {
    allelements = $("*");

if (!('webkitSpeechRecognition' in window)) {
  upgrade();
} else {
  var recognition = new webkitSpeechRecognition();
  recognition.continuous = false;

  recognition.onstart = function() {}
  recognition.onresult = function(event) {
  		for (var i = event.resultIndex; i < event.results.length; ++i) {
      if (event.results[i].isFinal) {
        final_transcript += event.results[i][0].transcript;
      } 
  }
  recognition.onerror = function(event) {

  }
  recognition.onend = function() {
  	/*stop record*/
  }
  

    
$(".recordbutton").click(function() {
	startButton();
	var potentialcommand = $("#command").val();

	console.log(final_transcript);

	var re = /^(click|scroll|enter)\s(.*)/i;
    var result = re.exec(final_transcript);

 	if(result) {
	  var verb = result[1];
      var arg = result[2]

      console.log("verb: " + verb + ", args: " + arg)

      switch(verb) {
      	case "click":

      
      	  console.log("handling click")

      	  //console.log($("*:contains('" + arg + "')"));

      	  var stringpieces = arg.split(/\s/);

      	  $("a,input,button").each(function() {
      	    if($(this)[0].tagName == "INPUT") {
      	    	var content = $(this).val();

      	    	if content = arg {
      	    		$(this).click();
      	    	}
      	    	// look for the text in INPUT fields

      	    } else if(($(this)[0].tagName == "A")) { 
      	    	$(this).click();

      	    	if (content=arg) {
      	    		$(this).click();
      	    	}
      	    }
      	  })

      	  break;
      	case "scroll":
      	  // what do we do on scroll?
      	  console.log("handling scroll`")
      	  break;
      	case "enter":
      	  // what do we do on enter?
      	  console.log("handling enter")
      	  break;
      	default:
      	  console.log("sorry, that is not a recognized command")
      }
  }
});


  function startButton(event) {

    final_transcript = '';
	recognition.lang = 'en-US';    
	recognition.start();
}



}
};
  </script>


</head>
<body>

<p>
<input id="thebutton" type="button" class ="recordbutton" value="Recording Start">
</p>

<p>
<a href="http://www.cmu.edu">Carnegie Mellon University</a>
</p>

<p>
  <input type="text" id="command" value="">
</p>

</body>

</html>